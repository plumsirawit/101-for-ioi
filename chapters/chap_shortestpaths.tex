\chapter{Shortest Paths}

\section{Dijkstra's Algorithm Variants}

\begin{exercise}
สำหรับปัญหาการหาเส้นทางที่สั้นที่สุดระหว่างจุดยอดสองจุดในกราฟไม่ระบุทิศทางถ่วงนำ้หนัก ที่ประกอบด้วย $N$ จุดยอด และ $M$ เส้นเชื่อม เรารู้ว่า Dijkstra's Algorithm ทำงานได้ใน $O(M \log N)$ อย่างไรก็ตาม สำหรับกราฟที่หนาแน่น (dense) มาก จะทำให้ $M \in \Theta(N^2)$ ทำให้อัลกอริทึมดังกล่าวทำงานใน $O(N^2 \log N)$ จงออกแบบอัลกอรทึมที่ดีกว่านี้ ที่ทำงานได้ใน $O(N^2)$
\end{exercise}

\begin{exercise}
นอกจากนี้ สำหรับกราฟที่นำ้หนักเป็นจำนวนเต็มที่รับประกันว่าผลรวมนำ้หนักมีค่าไม่เกิน $W$ จงออกแบบอัลกอริทึมที่หาเส้นทางที่สั้นที่สุดได้ใน $O(MW)$
\end{exercise}

\section{Systems of Inequalities}

\begin{exercise}
กำหนดตัวแปรไม่ทราบค่า $n$ ตัว คือ $x_1, x_2, \dots, x_n$ โดยค่าของแต่ละตัวเป็นจำนวนเต็ม กำหนดระบบของอสมการทั้งหมด $m$ อสมการ ในรูปแบบ $x_i \leq x_j + k$ สำหรับบางจำนวนเต็ม $1 \leq i, j \leq n$ และ $k$ จงออกแบบอัลกอริทึมที่ตอบค่ามากสุดของ $x_n - x_1$ ที่สอดคล้องกับระบบอสมการนี้
\end{exercise}

\section{Legacy}
\label{codeforces:786B}

ก่อนจะเข้าสู่ปัญหาหลัก มีข้อสังเกตหนึ่งมาให้พิจารณาก่อน

\begin{exercise}
ให้ $A, B$ เป็นเซตของจุดยอดที่ $A \cap B = \emptyset$ สำหรับกราฟ $G = (V, E)$ โดย $V = A \cup B$ และ $E = A \times B$ พิจารณากราฟ $G' = (V', E')$ โดย $V' = A \cup B \cup \{c^*\}$ เมื่อ $c^* \notin A, B$ เป็นจุดยอดพิเศษ และนิยาม $E' = A \times c^* \cup c^* \times B$

จงพิสูจน์ว่าสำหรับทุก $u, v \in V$, $d'(u, v) = 2d(u, v)$ โดย $d'(u, v)$ แทนระยะทางสั้นสุดจาก $u$ ไปยัง $v$ บน $G'$ และ $d(u, v)$ แทนระยะทางสั้นสุดจาก $u$ ไปยัง $v$ บน $G$
\end{exercise}

มีกราฟระบุทิศทางถ่วงนำ้หนักอยู่กราฟหนึ่ง โดยระบุจุดยอดเป็นจุด $1, \dots, n$ สำหรับบางจำนวนเต็มบวก $n$ ตอนแรกยังไม่มีเส้นเชื่อมใด ๆ

ต่อมามีการก่อสร้างทั้งหมด 3 รูปแบบ ซึ่งจะทำให้เกิดเส้นเชื่อมบนกราฟ โดยแต่ละรูปแบบเป็นดังต่อไปนี้

\begin{enumerate}
    \item สร้างเส้นเชื่อมจากจุดยอด $v$ ไปหาจุดยอด $u$ ด้วยนำ้หนัก $w$
    \item สร้างเส้นเชื่อมจากจุดยอด $v$ ไปหาทุกจุดยอด $u$ ในช่วง $[l, r]$ ด้วยนำ้หนัก $w$
    \item สร้างเส้นเชื่อมจากทุกจุดยอด $u$ ในช่วง $[l, r]$ ไปหาจุดยอด $v$ ด้วยนำ้หนัก $w$
\end{enumerate}

ให้จุดยอด $s$ มา แทนจุดยอดเริ่มต้น จงหาระยะทางสั้นสุดจาก $s$ ไปยัง $1, \dots, n$ หากไปไม่ได้ให้ตอบ $-1$

\begin{exercise}
จงออกแบบอัลกอริทึมที่สามารถแก้ปัญหานี้ได้ใน $O(n \log^2 n)$ เมื่อจำนวนการก่อสร้างมีอยู่ $n$ ครั้ง
\end{exercise}

โจทย์จาก \url{https://codeforces.com/problemset/problem/786/B}
